#!/usr/bin/env python3

import argparse
import json

from cxnminer.extractor import SyntacticNGramExtractor
from cxnminer.pattern_encoder import BitEncoder, HuffmanEncoder

from cxnminer.utils.helpers import open_file

if __name__ == "__main__":

  parser = argparse.ArgumentParser()
  parser.add_argument('dictionaries')
  parser.add_argument('outfile')
  args = parser.parse_args()

  with open_file(args.dictionaries) as dict_file:
    vocabularies = json.load(dict_file)

  pattern_encoder = HuffmanEncoder(vocabularies, SyntacticNGramExtractor.get_pattern_type())


  with open_file(args.outfile, 'wb') as outfile:
    pattern_encoder.save(outfile)
